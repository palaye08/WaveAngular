<div class="flex">
    <app-sidebar></app-sidebar>
    
    <div class="ml-64 flex-1 p-8 bg-gray-50 min-h-screen">
      <div class="max-w-4xl mx-auto">
        <h1 class="text-4xl font-bold text-gray-900 mb-8">ðŸŽ« Nouvelle RÃ©servation</h1>
        
        <!-- Info Vol Aller -->
        <div *ngIf="volAller" class="bg-white rounded-xl shadow-lg p-6 mb-6">
          <h3 class="text-xl font-bold mb-4">Vol SÃ©lectionnÃ©</h3>
          <div class="flex items-center justify-between">
            <div>
              <p class="text-2xl font-bold text-gold-600">{{ volAller.numeroVol }}</p>
              <p class="text-gray-600">{{ volAller.villeDepart.nom }} â†’ {{ volAller.villeArrivee.nom }}</p>
            </div>
            <div class="text-right">
              <p class="text-3xl font-bold text-gold-600">{{ volAller.prixBase | number:'1.0-0' }} FCFA</p>
              <p class="text-sm text-gray-500">Prix de base</p>
            </div>
          </div>
        </div>
  
        <!-- Formulaire -->
        <div class="bg-white rounded-xl shadow-lg p-8">
          <form [formGroup]="reservationForm" (ngSubmit)="onSubmit()">
            
            <!-- Type de RÃ©servation -->
            <div class="mb-6">
              <label class="block text-gray-700 font-semibold mb-2">Type de RÃ©servation</label>
              <div class="grid grid-cols-2 gap-4">
                <label *ngFor="let type of typesReservation" 
                       class="flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all"
                       [class.border-gold-500]="reservationForm.get('typeReservation')?.value === type"
                       [class.bg-gold-50]="reservationForm.get('typeReservation')?.value === type">
                  <input type="radio" formControlName="typeReservation" [value]="type" class="hidden">
                  <span class="text-lg font-medium">{{ type }}</span>
                </label>
              </div>
            </div>
  
            <!-- Classe de Vol -->
            <div class="mb-6">
              <label class="block text-gray-700 font-semibold mb-2">Classe de Vol</label>
              <div class="grid grid-cols-3 gap-4">
                <label *ngFor="let classe of classesVol" 
                       class="flex flex-col items-center p-4 border-2 rounded-lg cursor-pointer transition-all"
                       [class.border-gold-500]="reservationForm.get('classeVol')?.value === classe"
                       [class.bg-gold-50]="reservationForm.get('classeVol')?.value === classe">
                  <input type="radio" formControlName="classeVol" [value]="classe" class="hidden">
                  <span class="text-3xl mb-2">
                    {{ classe === 'ECONOMIQUE' ? 'ðŸ’º' : classe === 'PREMIUM' ? 'âœ¨' : 'ðŸ‘‘' }}
                  </span>
                  <span class="font-medium text-center">{{ getClasseLabel(classe) }}</span>
                </label>
              </div>
            </div>
  
            <div class="grid md:grid-cols-2 gap-6">
              <!-- Date DÃ©part -->
              <div>
                <label class="block text-gray-700 font-semibold mb-2">Date de DÃ©part</label>
                <input type="date" formControlName="dateDepart"
                       class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-gold-500 focus:outline-none">
              </div>
  
              <!-- Date Retour -->
              <div *ngIf="reservationForm.get('typeReservation')?.value === 'ALLER_RETOUR'">
                <label class="block text-gray-700 font-semibold mb-2">Date de Retour</label>
                <input type="date" formControlName="dateRetour"
                       class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-gold-500 focus:outline-none">
              </div>
  
              <!-- Nombre de Passagers -->
              <div>
                <label class="block text-gray-700 font-semibold mb-2">Nombre de Passagers</label>
                <input type="number" formControlName="nombrePassagers" min="1" max="10"
                       class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-gold-500 focus:outline-none">
              </div>
  
              <!-- Vol Retour -->
              <div *ngIf="reservationForm.get('typeReservation')?.value === 'ALLER_RETOUR' && volsRetour.length > 0">
                <label class="block text-gray-700 font-semibold mb-2">Vol Retour</label>
                <select formControlName="volRetourId"
                        class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-gold-500 focus:outline-none">
                  <option value="">SÃ©lectionner un vol retour</option>
                  <option *ngFor="let vol of volsRetour" [value]="vol.id">
                    {{ vol.numeroVol }} - {{ vol.heureDepart }} ({{ vol.prixBase | number:'1.0-0' }} FCFA)
                  </option>
                </select>
              </div>
            </div>
  
            <!-- Prix EstimÃ© -->
            <div class="mt-8 p-6 bg-gradient-to-r from-gold-500 to-gold-600 rounded-xl text-white">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-lg font-medium">Prix Total EstimÃ©</p>
                  <p class="text-sm text-gold-100">
                    {{ reservationForm.get('nombrePassagers')?.value || 1 }} passager(s) - 
                    Classe {{ reservationForm.get('classeVol')?.value }}
                  </p>
                </div>
                <p class="text-4xl font-bold">{{ prixEstime | number:'1.0-0' }} FCFA</p>
              </div>
            </div>
  
            <!-- Success Message -->
            <div *ngIf="showSuccess" 
                 class="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg text-green-600">
              âœ“ RÃ©servation crÃ©Ã©e avec succÃ¨s ! Redirection vers le paiement...
            </div>
  
            <!-- Submit Button -->
            <button type="submit" [disabled]="reservationForm.invalid || loading"
                    class="w-full btn-gold text-lg py-4 mt-6 disabled:opacity-50">
              <span *ngIf="!loading">Confirmer la RÃ©servation</span>
              <span *ngIf="loading">CrÃ©ation en cours...</span>
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>